@startuml
scale 350 width

raw_cmd --> StringProcessing
CommandInterface --> CommandClass : Inheritance
CommandInterface : def substitute_vars
CommandInterface : def execute

state StringProcessing {
  Lexer -> Parser : Tokens
  Lexer : Quotes interpetation
  Parser --> CommandClass : Existing Command
  Parser : Command extraction
}

Parser --> ExceptionHandling : Non-exisiting command
ExceptionHandling : NameError / KeyError

state Envs
Envs : Global storage of environment variables
CommandClass --> CommandObject : Object Creation
CommandObject --> Envs : (1) object.substitute_vars
Envs --> CommandObject : valid command
Envs --> ExceptionHandling : Non-existing variable

CommandObject --> Result : (2) object.execute

@enduml
